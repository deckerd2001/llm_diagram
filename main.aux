\relax 
\@writefile{toc}{\contentsline {section}{\numberline {1}서론}{5}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {1.1}범위와 목표}{5}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {1.2}대상 독자}{5}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {1.3}문서 구성}{6}{}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {2}배경: 신경망과 트랜스포머}{7}{}\protected@file@percent }
\newlabel{sec:background}{{2}{7}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.1}기본 표기와 텐서}{7}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {2.2}선형 레이어와 MLP 블록}{8}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {2.3}시퀀스 모델링과 자기어텐션 (Sequence Modeling and Self-Attention)}{8}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {2.4}표준 트랜스포머 블록 구조}{9}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {2.5}이후 내용과의 연결 (Connection to the Rest of the Document)}{9}{}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {3}기울기와 역전파의 기초}{10}{}\protected@file@percent }
\newlabel{sec:gradients-basics}{{3}{10}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.1}스칼라 손실과 기울기 표기}{10}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {3.2}단일 입력 노드와 역전파 연산자}{10}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {3.3}다중 입력 노드와 역전파 연산자}{11}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {3.4}다이어그램과의 연결}{11}{}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {4}그래프 표기와 도식 규칙}{12}{}\protected@file@percent }
\newlabel{sec:graph-conventions}{{4}{12}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.1}텐서 차원과 인덱스 표기}{12}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {4.2}순전파·역전파 노드의 추상적 구조}{13}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {4.3}노드 유형}{13}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{행렬 곱 (Matmul).}{13}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{원소별 비선형 함수 및 기타 연산.}{13}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{합/잔차 연결 (Add / Residual).}{13}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{레이어 정규화 (LayerNorm).}{13}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{브로드캐스트 (Broadcast).}{13}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {4.4}통신 노드 (All-Reduce, All-Gather 등)}{14}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {4.5}MHA/MLP 상세 도식 읽는 법}{14}{}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {5}단일 노드 트랜스포머: 순전파와 역전파}{15}{}\protected@file@percent }
\newlabel{sec:sn}{{5}{15}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {5.1}전체 트랜스포머 레이어 흐름}{15}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {1}{\ignorespaces 단일 노드 트랜스포머 레이어의 전체 순전파 및 역전파 흐름. 실선 화살표는 순전파 활성값을, 점선 화살표는 손실 $\mathcal  {L}$로부터 출력 프로젝션, MLP, MHA를 거쳐 입력 임베딩으로 되돌아가는 기울기 흐름을 나타낸다.}}{15}{}\protected@file@percent }
\providecommand*\caption@xref[2]{\@setref\relax\@undefined{#1}}
\newlabel{fig:single_node_overall}{{1}{15}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {5.2}입력 임베딩 레이어}{15}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {2}{\ignorespaces 입력 임베딩 레이어의 순전파. 토큰 ID는 임베딩 행렬 $\mathbf  {E}$를 통해 토큰 임베딩으로 변환되고, 위치 임베딩 $\mathbf  {P}$가 더해진 뒤, (선택적인) 드롭아웃을 거쳐 초기 은닉 상태 $\mathbf  {X} \in [B,S,D]$를 생성한다.}}{16}{}\protected@file@percent }
\newlabel{fig:single_node_input_embedding}{{2}{16}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {5.3}멀티헤드 어텐션 (MHA)}{16}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsubsection}{\numberline {5.3.1}순전파}{16}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(1) 입력 레이어 정규화.}{16}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(2) Q/K/V 선형 프로젝션.}{17}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(3) 스케일된 내적 어텐션.}{17}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(4) 헤드 결합 및 출력 프로젝션.}{17}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {3}{\ignorespaces 단일 노드 MHA 블록의 순전파. 입력 $\mathbf  {X}$는 레이어 정규화를 거쳐 Q/K/V 선형 프로젝션으로 매핑되고, 스케일된 내적 어텐션과 소프트맥스를 통해 값 텐서 $\mathbf  {V}$의 가중합을 계산한 뒤, 여러 헤드를 결합하여 $\mathbf  {A}_{\text  {out}} \in [B,S,D]$를 생성한다.}}{18}{}\protected@file@percent }
\newlabel{fig:single_node_mha_forward}{{3}{18}{}{}{}}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {5.3.2}역전파}{19}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {4}{\ignorespaces 단일 노드 MHA 블록의 역전파. 출력 $\mathbf  {A}_{\text  {out}}$에 대한 기울기에서 시작하여, 출력 프로젝션, 어텐션 연산, Q/K/V 선형 레이어, 레이어 정규화를 역순으로 거치며 입력과 파라미터에 대한 기울기를 계산한다.}}{20}{}\protected@file@percent }
\newlabel{fig:single_node_mha_backward}{{4}{20}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {5.4}피드포워드 네트워크 (MLP / FFN)}{21}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsubsection}{\numberline {5.4.1}순전파}{21}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(1) 레이어 정규화.}{21}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(2) 상향 선형 레이어 (up-projection).}{21}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(3) 비선형 활성 함수.}{21}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(4) 하향 선형 레이어 (down-projection).}{21}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(5) 잔차 연결.}{21}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {5}{\ignorespaces 단일 노드 MLP/FFN 블록의 순전파. 입력 $\mathbf  {X}_2$는 레이어 정규화를 거쳐 상향 선형 레이어, 비선형 활성 함수, 하향 선형 레이어를 통과한 뒤, 잔차 연결을 통해 $\mathbf  {X}_{\text  {out}}$을 형성한다.}}{21}{}\protected@file@percent }
\newlabel{fig:single_node_mlp_forward}{{5}{21}{}{}{}}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {5.4.2}역전파}{22}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {6}{\ignorespaces 단일 노드 MLP/FFN 블록의 역전파. 잔차 연결, 하향/상향 선형 레이어, 비선형 함수, 레이어 정규화를 역순으로 통과하며, 각 입력과 파라미터에 대한 기울기를 계산한다.}}{22}{}\protected@file@percent }
\newlabel{fig:single_node_mlp_backward}{{6}{22}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {5.5}출력 프로젝션과 손실}{22}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsubsection}{\numberline {5.5.1}순전파 (로그릿, 소프트맥스, 손실)}{22}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {7}{\ignorespaces 출력 프로젝션과 손실의 순전파. 은닉 상태 $\mathbf  {X}_{\text  {out}}$는 언어 모델 프로젝션 $(W_{\text  {lm}}, \mathbf  {b}_{\text  {lm}})$을 통해 로그릿으로 변환되고, 소프트맥스와 교차 엔트로피를 거쳐 스칼라 손실 $\mathcal  {L}$이 계산된다.}}{23}{}\protected@file@percent }
\newlabel{fig:single_node_output_forward}{{7}{23}{}{}{}}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {5.5.2}역전파}{23}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {8}{\ignorespaces 출력 프로젝션과 손실의 역전파. 손실로부터의 기울기는 소프트맥스와 교차 엔트로피를 거쳐 로그릿으로 전달되고, 다시 언어 모델 프로젝션을 통해 $\mathrm  {d}\mathbf  {A}_{\text  {out}}$과 파라미터 기울기 $\mathrm  {d}\mathbf  {W}_{\text  {lm}}$, $\mathrm  {d}\mathbf  {b}_{\text  {lm}}$를 만들어 낸다.}}{23}{}\protected@file@percent }
\newlabel{fig:single_node_output_backward}{{8}{23}{}{}{}}
\@writefile{toc}{\contentsline {section}{\numberline {6}텐서 병렬화}{24}{}\protected@file@percent }
\newlabel{sec:tp}{{6}{24}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {6.1}텐서 병렬 분할 개요}{24}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {9}{\ignorespaces 텐서 병렬화가 적용된 전체 트랜스포머 레이어. 단일 노드 모델의 큰 선형 레이어는 $N_T$개의 작은 matmul로 나뉘어 서로 다른 디바이스에서 실행된다. 색깔 화살표는 부분 결과를 모으기 위해 집합 통신 (예: All-Reduce, All-Gather)이 필요한 위치를 나타내고, 나머지 로컬 계산은 Figure~\ref {fig:single_node_overall}과 구조적으로 동일하다.}}{25}{}\protected@file@percent }
\newlabel{fig:tp_overall_flow}{{9}{25}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {6.2}텐서 병렬화된 MHA}{25}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsubsection}{\numberline {6.2.1}순전파}{25}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(1) 정규화와 공유 입력.}{25}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(2) Q/K/V 컬럼 병렬 프로젝션.}{26}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(3) 로컬 스케일드 어텐션.}{26}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(4) 헤드 결합과 로우 병렬 출력 프로젝션.}{26}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {10}{\ignorespaces 텐서 병렬화된 MHA의 순전파. Q/K/V 프로젝션은 컬럼 병렬 선형으로 구현되어, 각 디바이스가 일부 헤드만을 소유한다. 각 디바이스는 자신이 담당하는 헤드에 대해 어텐션을 로컬로 계산하고, 헤드 출력들을 합친 뒤, 로우 병렬 출력 프로젝션을 적용한다. 이후 All-Reduce를 통해 모든 디바이스에서 단일 노드와 동일한 $\mathbf  {A}_{\text  {out}}$를 복원한다.}}{27}{}\protected@file@percent }
\newlabel{fig:mha_forward_tp}{{10}{27}{}{}{}}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {6.2.2}역전파}{28}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {11}{\ignorespaces 텐서 병렬화된 MHA의 역전파. 각 디바이스는 로컬 Q/K/V 프로젝션과 자신이 담당하는 어텐션 헤드를 따라 역전파를 수행한다. 정규화된 입력에 대한 기울기는 All-Reduce를 통해 모든 디바이스에서 합산되며, 파라미터 기울기는 각 shard $W_Q^{(t)}, W_K^{(t)}, W_V^{(t)}, W_O^{(t)}$에 대해 로컬로 누적된다.}}{29}{}\protected@file@percent }
\newlabel{fig:mha_backward_tp}{{11}{29}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {6.3}텐서 병렬화된 MLP}{30}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsubsection}{\numberline {6.3.1}순전파}{30}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(1) 컬럼 병렬 상향 프로젝션.}{30}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(2) 로컬 비선형 활성 함수.}{30}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(3) 로우 병렬 하향 프로젝션.}{30}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{(4) 드롭아웃과 잔차 연결.}{30}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {12}{\ignorespaces 텐서 병렬화된 MLP의 순전파. 상향 프로젝션은 컬럼 병렬 선형으로 구현되어, 각 디바이스가 중간 피처의 일부만을 보유한다. 하향 프로젝션은 로우 병렬로 구현되며, 디바이스 간 All-Reduce를 통해 전체 $\mathbf  {Z}_{\text  {down}}$를 복원한 뒤, 드롭아웃과 잔차 연결이 로컬로 적용된다.}}{31}{}\protected@file@percent }
\newlabel{fig:mlp_forward_tp}{{12}{31}{}{}{}}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {6.3.2}역전파}{31}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {6.4}요약}{31}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {13}{\ignorespaces 텐서 병렬화된 MLP의 역전파. 로우 병렬 down-projection, 활성 함수, 컬럼 병렬 up-projection, (필요 시) 레이어 정규화를 역순으로 따라가며, 각 shard 파라미터와 입력에 대한 기울기를 계산한다. 특히 up-projection에서 얻은 입력 기울기 $\mathrm  {d}\mathbf  {H}^{(t)}$는 All-Reduce를 통해 합산되어 전역 $\mathrm  {d}\mathbf  {H}$를 형성한다.}}{32}{}\protected@file@percent }
\newlabel{fig:mlp_backward_tp}{{13}{32}{}{}{}}
\@writefile{toc}{\contentsline {section}{\numberline {7}데이터 병렬화}{33}{}\protected@file@percent }
\newlabel{sec:dp}{{7}{33}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {7.1}데이터 병렬 학습 전체 흐름}{33}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {14}{\ignorespaces 데이터 병렬화가 적용된 트랜스포머 레이어 전체 구조. 각 디바이스는 모델 전체를 한 벌씩 가지고 있고, 서로 다른 입력 배치 조각($\mathbf  {X}_i$, $\mathbf  {X}_j$, \dots  )을 처리한다. 순전파와 역전파는 단일 노드와 동일하게 로컬에서 수행되며, 각 블록(MHA, MLP, 출력 프로젝션)의 기울기는 All-Reduce를 통해 복제본 간에 동기화된다.}}{34}{}\protected@file@percent }
\newlabel{fig:dp_overall_flow}{{14}{34}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {7.2}단일 노드 계산과의 관계}{34}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {7.3}데이터 병렬 환경에서의 MHA 역전파}{35}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {15}{\ignorespaces 데이터 병렬 환경에서의 멀티헤드 어텐션 역전파. 각 복제본은 자신의 미니배치를 사용해 $W_Q$, $W_K$, $W_V$, $W_O$에 대한 로컬 기울기를 계산한다. 붉은 점선 화살표는 모든 데이터 병렬 복제본에 걸쳐 이러한 로컬 기울기를 All-Reduce하여, 옵티마이저에서 사용하는 전역 기울기를 형성하는 위치를 나타낸다. 블록 내부의 역전파 그래프 구조는 단일 노드 경우와 동일하다.}}{36}{}\protected@file@percent }
\newlabel{fig:mha_backward_dp}{{15}{36}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {7.4}데이터 병렬 환경에서의 MLP 역전파}{37}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {7.5}통신 및 메모리 고려사항}{37}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {16}{\ignorespaces 데이터 병렬 환경에서의 MLP 역전파. 각 복제본은 자신의 미니배치를 사용해 up-/down-projection 가중치와 bias에 대한 로컬 기울기를 계산한다. 붉은 박스와 점선 화살표는 데이터 병렬 복제본 전체에 걸쳐 이러한 기울기를 All-Reduce하여 전역 기울기를 형성하는 위치를 나타낸다.}}{38}{}\protected@file@percent }
\newlabel{fig:mlp_backward_dp}{{16}{38}{}{}{}}
\@writefile{toc}{\contentsline {section}{\numberline {8}데이터 병렬화와 텐서 병렬화의 결합}{39}{}\protected@file@percent }
\newlabel{sec:dp_tp}{{8}{39}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {8.1}병렬 그룹과 레이아웃}{39}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {8.2}단일 노드에서 텐서 병렬화, 그리고 데이터+텐서 병렬화까지}{39}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{단일 노드 (Section~\ref {sec:sn}).}{39}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{텐서 병렬화만 적용 (Section~\ref {sec:tp}).}{39}{}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {17}{\ignorespaces 데이터 병렬화와 텐서 병렬화가 결합된 전체 트랜스포머 레이어. 가로 방향으로는 각 텐서 병렬 그룹($N_T$ 디바이스)이 하나의 샤딩된 레이어(Section~\ref {sec:tp})를 함께 구현한다. 세로 방향으로는 그러한 그룹 $N_D$개가 데이터 병렬 격자를 이룬다. 각 행은 서로 다른 미니배치 조각을 처리하며, 기울기는 행들 사이에서 동기화된다. All-Reduce와 All-Gather 집합 통신이 사용되는 위치가 그림에 함께 표시된다.}}{40}{}\protected@file@percent }
\newlabel{fig:dp_tp_overall_flow}{{17}{40}{}{}{}}
\@writefile{toc}{\contentsline {paragraph}{데이터 병렬화만 적용 (Section~\ref {sec:dp}).}{41}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{데이터 병렬화와 텐서 병렬화를 결합.}{41}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {8.3}데이터+텐서 병렬 환경에서의 순전파}{41}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {8.4}데이터+텐서 병렬 환경에서의 역전파와 기울기 동기화}{41}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {8.5}통신 요약 및 TP/DP 단독 설정과의 비교}{42}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{TP-only와 비교.}{42}{}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{DP-only와 비교.}{42}{}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {9}요약과 실용적인 정리}{43}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {9.1}기울기에서 그래프, 그리고 트랜스포머로}{43}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {9.2}연산량과 메모리: 무엇이 중요한가}{43}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {9.3}단일 노드, TP, DP, DP+TP 비교}{44}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {9.4}도식 읽는 방법과 활용}{44}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {9.5}실용적인 규칙 정리}{45}{}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {9.6}다음 단계}{45}{}\protected@file@percent }
\gdef \@abspage@last{45}
