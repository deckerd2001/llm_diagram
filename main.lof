\contentsline {figure}{\numberline {1}{\ignorespaces 단일 노드 트랜스포머 레이어의 전체 순전파 및 역전파 흐름. 실선 화살표는 순전파 활성값을, 점선 화살표는 손실 $\mathcal {L}$로부터 출력 프로젝션, MLP, MHA를 거쳐 입력 임베딩으로 되돌아가는 기울기 흐름을 나타낸다.}}{15}{}%
\contentsline {figure}{\numberline {2}{\ignorespaces 입력 임베딩 레이어의 순전파. 토큰 ID는 임베딩 행렬 $\mathbf {E}$를 통해 토큰 임베딩으로 변환되고, 위치 임베딩 $\mathbf {P}$가 더해진 뒤, (선택적인) 드롭아웃을 거쳐 초기 은닉 상태 $\mathbf {X} \in [B,S,D]$를 생성한다.}}{16}{}%
\contentsline {figure}{\numberline {3}{\ignorespaces 단일 노드 MHA 블록의 순전파. 입력 $\mathbf {X}$는 레이어 정규화를 거쳐 Q/K/V 선형 프로젝션으로 매핑되고, 스케일된 내적 어텐션과 소프트맥스를 통해 값 텐서 $\mathbf {V}$의 가중합을 계산한 뒤, 여러 헤드를 결합하여 $\mathbf {A}_{\text {out}} \in [B,S,D]$를 생성한다.}}{18}{}%
\contentsline {figure}{\numberline {4}{\ignorespaces 단일 노드 MHA 블록의 역전파. 출력 $\mathbf {A}_{\text {out}}$에 대한 기울기에서 시작하여, 출력 프로젝션, 어텐션 연산, Q/K/V 선형 레이어, 레이어 정규화를 역순으로 거치며 입력과 파라미터에 대한 기울기를 계산한다.}}{20}{}%
\contentsline {figure}{\numberline {5}{\ignorespaces 단일 노드 MLP/FFN 블록의 순전파. 입력 $\mathbf {X}_2$는 레이어 정규화를 거쳐 상향 선형 레이어, 비선형 활성 함수, 하향 선형 레이어를 통과한 뒤, 잔차 연결을 통해 $\mathbf {X}_{\text {out}}$을 형성한다.}}{21}{}%
\contentsline {figure}{\numberline {6}{\ignorespaces 단일 노드 MLP/FFN 블록의 역전파. 잔차 연결, 하향/상향 선형 레이어, 비선형 함수, 레이어 정규화를 역순으로 통과하며, 각 입력과 파라미터에 대한 기울기를 계산한다.}}{22}{}%
\contentsline {figure}{\numberline {7}{\ignorespaces 출력 프로젝션과 손실의 순전파. 은닉 상태 $\mathbf {X}_{\text {out}}$는 언어 모델 프로젝션 $(W_{\text {lm}}, \mathbf {b}_{\text {lm}})$을 통해 로그릿으로 변환되고, 소프트맥스와 교차 엔트로피를 거쳐 스칼라 손실 $\mathcal {L}$이 계산된다.}}{23}{}%
\contentsline {figure}{\numberline {8}{\ignorespaces 출력 프로젝션과 손실의 역전파. 손실로부터의 기울기는 소프트맥스와 교차 엔트로피를 거쳐 로그릿으로 전달되고, 다시 언어 모델 프로젝션을 통해 $\mathrm {d}\mathbf {A}_{\text {out}}$과 파라미터 기울기 $\mathrm {d}\mathbf {W}_{\text {lm}}$, $\mathrm {d}\mathbf {b}_{\text {lm}}$를 만들어 낸다.}}{23}{}%
\contentsline {figure}{\numberline {9}{\ignorespaces 텐서 병렬화가 적용된 전체 트랜스포머 레이어. 단일 노드 모델의 큰 선형 레이어는 $N_T$개의 작은 matmul로 나뉘어 서로 다른 디바이스에서 실행된다. 색깔 화살표는 부분 결과를 모으기 위해 집합 통신 (예: All-Reduce, All-Gather)이 필요한 위치를 나타내고, 나머지 로컬 계산은 Figure~\ref {fig:single_node_overall}과 구조적으로 동일하다.}}{25}{}%
\contentsline {figure}{\numberline {10}{\ignorespaces 텐서 병렬화된 MHA의 순전파. Q/K/V 프로젝션은 컬럼 병렬 선형으로 구현되어, 각 디바이스가 일부 헤드만을 소유한다. 각 디바이스는 자신이 담당하는 헤드에 대해 어텐션을 로컬로 계산하고, 헤드 출력들을 합친 뒤, 로우 병렬 출력 프로젝션을 적용한다. 이후 All-Reduce를 통해 모든 디바이스에서 단일 노드와 동일한 $\mathbf {A}_{\text {out}}$를 복원한다.}}{27}{}%
\contentsline {figure}{\numberline {11}{\ignorespaces 텐서 병렬화된 MHA의 역전파. 각 디바이스는 로컬 Q/K/V 프로젝션과 자신이 담당하는 어텐션 헤드를 따라 역전파를 수행한다. 정규화된 입력에 대한 기울기는 All-Reduce를 통해 모든 디바이스에서 합산되며, 파라미터 기울기는 각 shard $W_Q^{(t)}, W_K^{(t)}, W_V^{(t)}, W_O^{(t)}$에 대해 로컬로 누적된다.}}{29}{}%
\contentsline {figure}{\numberline {12}{\ignorespaces 텐서 병렬화된 MLP의 순전파. 상향 프로젝션은 컬럼 병렬 선형으로 구현되어, 각 디바이스가 중간 피처의 일부만을 보유한다. 하향 프로젝션은 로우 병렬로 구현되며, 디바이스 간 All-Reduce를 통해 전체 $\mathbf {Z}_{\text {down}}$를 복원한 뒤, 드롭아웃과 잔차 연결이 로컬로 적용된다.}}{31}{}%
\contentsline {figure}{\numberline {13}{\ignorespaces 텐서 병렬화된 MLP의 역전파. 로우 병렬 down-projection, 활성 함수, 컬럼 병렬 up-projection, (필요 시) 레이어 정규화를 역순으로 따라가며, 각 shard 파라미터와 입력에 대한 기울기를 계산한다. 특히 up-projection에서 얻은 입력 기울기 $\mathrm {d}\mathbf {H}^{(t)}$는 All-Reduce를 통해 합산되어 전역 $\mathrm {d}\mathbf {H}$를 형성한다.}}{32}{}%
\contentsline {figure}{\numberline {14}{\ignorespaces 데이터 병렬화가 적용된 트랜스포머 레이어 전체 구조. 각 디바이스는 모델 전체를 한 벌씩 가지고 있고, 서로 다른 입력 배치 조각($\mathbf {X}_i$, $\mathbf {X}_j$, \dots )을 처리한다. 순전파와 역전파는 단일 노드와 동일하게 로컬에서 수행되며, 각 블록(MHA, MLP, 출력 프로젝션)의 기울기는 All-Reduce를 통해 복제본 간에 동기화된다.}}{34}{}%
\contentsline {figure}{\numberline {15}{\ignorespaces 데이터 병렬 환경에서의 멀티헤드 어텐션 역전파. 각 복제본은 자신의 미니배치를 사용해 $W_Q$, $W_K$, $W_V$, $W_O$에 대한 로컬 기울기를 계산한다. 붉은 점선 화살표는 모든 데이터 병렬 복제본에 걸쳐 이러한 로컬 기울기를 All-Reduce하여, 옵티마이저에서 사용하는 전역 기울기를 형성하는 위치를 나타낸다. 블록 내부의 역전파 그래프 구조는 단일 노드 경우와 동일하다.}}{36}{}%
\contentsline {figure}{\numberline {16}{\ignorespaces 데이터 병렬 환경에서의 MLP 역전파. 각 복제본은 자신의 미니배치를 사용해 up-/down-projection 가중치와 bias에 대한 로컬 기울기를 계산한다. 붉은 박스와 점선 화살표는 데이터 병렬 복제본 전체에 걸쳐 이러한 기울기를 All-Reduce하여 전역 기울기를 형성하는 위치를 나타낸다.}}{38}{}%
\contentsline {figure}{\numberline {17}{\ignorespaces 데이터 병렬화와 텐서 병렬화가 결합된 전체 트랜스포머 레이어. 가로 방향으로는 각 텐서 병렬 그룹($N_T$ 디바이스)이 하나의 샤딩된 레이어(Section~\ref {sec:tp})를 함께 구현한다. 세로 방향으로는 그러한 그룹 $N_D$개가 데이터 병렬 격자를 이룬다. 각 행은 서로 다른 미니배치 조각을 처리하며, 기울기는 행들 사이에서 동기화된다. All-Reduce와 All-Gather 집합 통신이 사용되는 위치가 그림에 함께 표시된다.}}{40}{}%
